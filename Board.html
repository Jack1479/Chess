<!DOCTYPE html>
<html>
    <head>
        <title>Chess Board</title>
        <link rel = 'stylesheet' href = 'style.css' />
    </head>
    <body>
    <div class = "Chessboard">
        <!-- Rank 8 -->
        <div class = "white square" >
         <div class = 'number dark' id = '8row'>8</div>
         <div class = 'piece brook'>
         <img src = 'images/b rook.png' alt="rook">
         </div>
        </div>
        <div class = "black square">
         <div class = 'piece bknight'>
         <img src = 'images/b knight.png' alt="knight">
         </div>
        </div>
        <div class = "white square">
         <div class = 'piece bbishop'>
         <img src = 'images/b bishop.png' alt="bishop">
         </div>
        </div>
        <div class = "black square">
         <div class = 'piece bqueen'>
         <img src = 'images/b queen.png' alt="queen">
         </div>
        </div>
        <div class = "white square">
         <div class = 'piece bking'>
         <img src = 'images/b king.png' alt="king">
         </div>
        </div>
        <div class = "black square">
         <div class = 'piece bbishop'>
         <img src = 'images/b bishop.png' alt="bishop">
         </div>
        </div>
        <div class = "white square">
         <div class = 'piece bknight'>
         <img src = 'images/b knight.png' alt="knight">
         </div>
        </div>
        <div class = "black square">
         <div class = 'piece brook'>
         <img src = 'images/b rook.png' alt="rook">
         </div>
        </div>
        <!-- Rank 7 -->
        <div class = "black square">
         <div class = 'number light' id="'7row">7</div>
         <div class = 'piece bpawn'>
         <img src = 'images/b pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "white square">
         <div class = 'piece bpawn'>
         <img src = 'images/b pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "black square">
         <div class = 'piece bpawn'>
         <img src = 'images/b pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "white square">
         <div class = 'piece bpawn'>
         <img src = 'images/b pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "black square">
         <div class = 'piece bpawn'>
         <img src = 'images/b pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "white square">
         <div class = 'piece bpawn'>
         <img src = 'images/b pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "black square">
         <div class = 'piece bpawn'>
         <img src = 'images/b pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "white square">
         <div class = 'piece bpawn'>
         <img src = 'images/b pawn.png' alt="pawn">
         </div>
        </div>
        <!-- Rank 6 -->
        <div class = "white square">
         <div class = 'number dark' id="'6row">6</div>
        </div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <div class = "black square"></div>
        <!-- Rank 5 -->
        <div class = "black square">
         <div class = 'number light' id="'5row">5</div>
        </div>
        <div class = "white square"></div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <!-- Rank 4 -->
        <div class = "white square">
         <div class = 'number dark' id="'4row">4</div>
        </div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <div class = "black square"></div>
         <!-- Rank 3 -->
        <div class = "black square">
         <div class = 'number light' id = '3row'>3</div>
        </div>
        <div class = "white square"></div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <div class = "black square"></div>
        <div class = "white square"></div>
        <!-- Rank 2 -->
        <div class = "white square">
         <div class = 'number dark' id="'2row">2</div>
         <div class = 'piece wpawn'>
         <img src = 'images/w pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "black square">
         <div class = 'piece wpawn'>
         <img src = 'images/w pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "white square">
         <div class = 'piece wpawn'>
         <img src = 'images/w pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "black square">
         <div class = 'piece wpawn'>
         <img src = 'images/w pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "white square">
         <div class = 'piece wpawn'>
        <img src = 'images/w pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "black square">
         <div class = 'piece wpawn'>
         <img src = 'images/w pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "white square">
         <div class = 'piece wpawn'>
         <img src = 'images/w pawn.png' alt="pawn">
         </div>
        </div>
        <div class = "black square">
         <div class = 'piece wpawn'>
         <img src = 'images/w pawn.png' alt="pawn">
         </div>
        </div>
        <!-- Rank 1 -->
        <div class = "black square">
         <div class = "letter light" id="acolumn">a</div>
         <div class = 'number light' id="'1row">1</div>
         <div class = 'piece wrook'>
         <img src = 'images/w rook.png' alt="rook">
         </div>
        </div>
        <div class = "white square">
         <div class = 'letter dark'id="bcolumn">b</div>
         <div class = 'piece wknight'>
         <img src = 'images/w knight.png' alt="knight">
         </div>
        </div>
        <div class = "black square">
         <div class = 'letter light'id="ccolumn">c</div>
         <div class = 'piece wbishop'>
         <img src = 'images/w bishop.png' alt="bishop">
         </div>
        </div>
        <div class = "white square">
         <div class = 'letter dark'id="dcolumn">d</div>
         <div class = 'piece wking'>
         <img src = 'images/w king.png' alt="king">
         </div>
        </div>
        <div class = "black square">
         <div class = 'letter light'id="ecolumn">e</div>
         <div class = 'piece wqueen'>
         <img src = 'images/w queen.png' alt="queen">
         </div>
        </div>
        <div class = "white square">
         <div class = 'letter dark'id="fcolumn">f</div>
         <div class = 'piece wbishop'>
         <img src = 'images/w bishop.png' alt="bishop">
         </div>
        </div>
        <div class = "black square">
         <div class = 'letter light'id="gcolumn">g</div>
         <div class = 'piece wknight'>
         <img src = 'images/w knight.png' alt="knight">
         </div>
        </div>
        <div class = "white square">
         <div class = 'letter dark'id="hcolumn">h</div>
         <div class = 'piece wrook'>
         <img src = 'images/w rook.png' alt="rook">
         </div>
    </div>
    <div class = 'frame'>
     <iframe src="Tutorial.html" id = 'tutorial_page' height = '750' width = '750' style = 'border:none; text-align: center; display:none;' ></iframe>
    </div>
    <button class = 'tutorial' id = 'openbutton'>Tutorial</button>
    <button class = 'exit' id = 'close_button' hidden>X</button>
    <button class = 'timerbtn' id = 'timer' style = 'background-color: red;'>Timer toggle</button>
    <script>
        const open = document.getElementById('openbutton');
        const close = document.getElementById('close_button')
        const tut = document.getElementById('tutorial_page');
        open.addEventListener('click' , () => {
            tut.style.display = 'block'
            close.style.display = 'block';
        });
        
        close.addEventListener('click', () => {
            tut.style.display = 'none';
            close.style.display = 'none';
        });
        
    const pieceimg = document.getElementsByTagName('img')
    const allsquares = document.getElementsByClassName('square')
    const pieces = document.getElementsByClassName('piece')
    const rows = document.getElementById('row')
    const columns = document.getElementById('column')

    let selected = null;
    let from = null;


    function setup(){
        for(let i=0;i<allsquares.length;i++ ){    /* loops through all squares on the board and adds an event listener to each one*/
            allsquares[i].addEventListener('click' , allowplace); /* loops through all squares on the board and adds an event listener to each one*/
            let row=8-Math.floor(i/8);       /*adding row coordinates 1-8*/
            let column=String.fromCharCode(97+(i%8));     /*adding column coordinates a-h*/
            let square=allsquares[i];
            square.id=column+row;
        }
    }

    setup();

    function setuppieces(){
        for(let i=0;i<pieces.length;i++ ){      /* loops through all pieces on the board and adds an event listener to each one*/
        pieces[i].addEventListener('click', allowclick);     /* loops through all pieces on the board and adds an event listener to each one*/
        pieces[i].id=pieces[i].className.split(' ')[1];  /* giving each piece it name through taking the second part of its class name e.g.brook. for black rook*/
    }}
    
    setuppieces();


    function allowclick(e){
        e.stopPropagation(); 
        const piece = e.currentTarget;   /* sets variable piece to be the current target to be moved */
        if(selected === piece){   /* if you click the piece twice then it unselects it */
            unhighlight();        /* function to unselect */
            selected = null;      /* reset to nothing selected */
            from = null;          /* reset to nothing selected */
            return;
        }
        unhighlight();          
        selected = piece;
        from = piece.parentElement;   /* this variable holds the position that piece came from which will be useful for validation */
        highlight();        /* function to highlight selected piece */
    }

    function allowplace(e){
        const square = e.currentTarget;   /* sets the square you will place on to be the target */
        if (!selected) return;         /* makes sure a piece is selected */
        const targetpiece = square.querySelector('.piece');  /* makes the constant targetpiece  whatever is current on that square e.g. if empty targetpiece = null*/
        if (targetpiece && targetpiece !== selected){         /* makes sure you cant put the piece you are moving ontop of itsself */
            targetpiece.remove();                           /* removes the current piece on that square */
    }
        square.appendChild(selected);     /* appends your clicked piece onto the clicked square */
        unhighlight();                  /* unhighlights once piece is moved */ 
        selected = null     /* resets once piece is moved */
        from = null          /* resets once piece is moved */
    }

    function unhighlight(){
        if (selected) selected.classList.remove('highlight')         /* function to remove highlight when function is called */
    }

    function highlight(){
        if (selected) selected.classList.add('highlight')       /* function to add highlight when function is called */
    }
    </script>
    </body>
</html>